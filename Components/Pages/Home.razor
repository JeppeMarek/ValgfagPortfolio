@page "/"
@using Microsoft.IdentityModel.Tokens
@rendermode InteractiveServer
@inject IDialogService DialogService
@inject CategoryService categoryService

<PageTitle>Jeppe Marek Portfolio</PageTitle>
<header>Jeppe Marek Portfolio</header>
<MudButton @onclick="OpenCategoryDialogAsync" Variant="Variant.Filled" Color="Color.Primary">
    Create new Category
</MudButton>
<MudGrid>
    @if (!categories.IsNullOrEmpty())
    {
        foreach (var cat in categories)
        {
            <MudItem>
                <MudCard>
                    <MudCardHeader>
                        @cat.Title
                    </MudCardHeader>
                    <MudCardContent>
                        @cat.Description
                    </MudCardContent>
                </MudCard>
            </MudItem>
        }
    }
</MudGrid>




@code
{
    private List<Model.Category> categories;

    private async Task GetAllCategories()
    {
        categories = await categoryService.GetAllCategories();
    }

    private async Task OpenCategoryDialogAsync()
    {
        var options = new DialogOptions { CloseOnEscapeKey = true };
        await DialogService.ShowAsync<NewCategoryDialog>("New Category", options);
    }

    protected override async Task OnInitializedAsync()
    {
        await GetAllCategories();
        var testCategory = new Model.Category
        {
            Title = "Test",
            Description = "Det her er noget tekst for at teste hvordan det kommer til at se ud",
            CoverImgPath = "./wwwroot/Images/Category-Class.png",
            LogoImgPath = "./wwwroot/Images/Logo-lib.png",
            Id = 9999
        };
        var testCategory2 = new Model.Category
        {
            Title = "Test2",
            Description = "Det her er noget tekst for at teste hvordan det kommer til at se ud",
            CoverImgPath = "./wwwroot/Images/Category-Class.png",
            LogoImgPath = "./wwwroot/Images/Logo-lib.png",
            Id = 9998
        };
        categories.Add(testCategory);
        categories.Add(testCategory2);
    }
}
